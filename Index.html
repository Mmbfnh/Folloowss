<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¬Ù… Ø§Ù„ØªØ±ÙƒÙŠØ² - Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Firebase</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ø¥Ø¶Ø§ÙØ© Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
        }
        
        .hover-lift {
            transition: all 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        .dark-mode {
            background: linear-gradient(135deg, #1e293b, #334155);
            color: #f1f5f9;
        }
        
        .dark-mode .glass-effect {
            background: rgba(30, 41, 59, 0.7);
            color: #f1f5f9;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #6366f1;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .firebase-badge {
            background: linear-gradient(135deg, #ffa000, #ffca28);
            color: #5d4037;
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() { 
            const [step, setStep] = useState(0); 
            const [children, setChildren] = useState([]); 
            const [currentChildIndex, setCurrentChildIndex] = useState(0); 
            const [newChild, setNewChild] = useState({ 
                name: "", 
                birthDate: "", 
                focusLevel: "Ù…ØªÙˆØ³Ø·", 
                wakeTime: "05:30", 
                sleepTime: "20:30", 
                subjects: [], 
                exams: [],
                weeklySchedule: {
                    Ø§Ù„Ø³Ø¨Øª: [], Ø§Ù„Ø£Ø­Ø¯: [], Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†: [], Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡: [], Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡: [], Ø§Ù„Ø®Ù…ÙŠØ³: [], Ø§Ù„Ø¬Ù…Ø¹Ø©: []
                },
                goals: [],
                stars: 0, 
                completed: [],
                achievements: [],
                studyTime: 0,
                avatar: "ğŸ‘¦",
                createdAt: new Date().toISOString()
            }); 
            const [dailyPlan, setDailyPlan] = useState([]); 
            const [rewards, setRewards] = useState([ 
                { id: 1, name: "ÙˆØ³Ø§Ù… Ø±Ù‚Ù…ÙŠ", type: "digital", starsRequired: 5, icon: "ğŸ†" }, 
                { id: 2, name: "ÙˆÙ‚Øª Ù„Ø¹Ø¨Ø© 30 Ø¯Ù‚ÙŠÙ‚Ø©", type: "real", starsRequired: 10, icon: "ğŸ®" }, 
                { id: 3, name: "Ø®Ø±ÙˆØ¬ Ù„Ù„Ø­Ø¯ÙŠÙ‚Ø©", type: "real", starsRequired: 15, icon: "ğŸŒ³" },
                { id: 4, name: "ÙˆØ¬Ø¨Ø© Ù…ÙØ¶Ù„Ø©", type: "real", starsRequired: 20, icon: "ğŸ•" }
            ]);
            const [newReward, setNewReward] = useState({ name: "", starsRequired: 10, icon: "ğŸ" });
            const [notification, setNotification] = useState({ show: false, message: "", type: "" });
            const [showExamForm, setShowExamForm] = useState(false);
            const [newExam, setNewExam] = useState({ subject: "", date: "", time: "", importance: "Ø¹Ø§Ø¯ÙŠ", notes: "" });
            const [activeTab, setActiveTab] = useState("Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©");
            const [showGoalForm, setShowGoalForm] = useState(false);
            const [newGoal, setNewGoal] = useState({ title: "", targetDate: "", priority: "Ù…ØªÙˆØ³Ø·", description: "" });
            const [darkMode, setDarkMode] = useState(false);
            const [studyTimer, setStudyTimer] = useState({ active: false, startTime: null, currentSubject: null });
            const [showAvatarSelector, setShowAvatarSelector] = useState(false);
            const [showRewardForm, setShowRewardForm] = useState(false);
            const [loading, setLoading] = useState(false);
            const [firebaseInitialized, setFirebaseInitialized] = useState(false);
            const [useFirebase, setUseFirebase] = useState(false);
            
            const avatars = ["ğŸ‘¦", "ğŸ‘§", "ğŸ§‘", "ğŸ‘©", "ğŸ¦¸", "ğŸ¦¹", "ğŸ§™", "ğŸ§š", "ğŸ‘¨â€ğŸš€", "ğŸ‘©â€ğŸš€"];

            // ØªÙƒÙˆÙŠÙ† Firebase - Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø¨Ù…ÙØ§ØªÙŠØ­ Ù…Ø´Ø±ÙˆØ¹Ùƒ
            const firebaseConfig = {
                apiKey: "AIzaSyDEMO_KEY_REPLACE_THIS",
                authDomain: "your-project.firebaseapp.com",
                projectId: "your-project-id",
                storageBucket: "your-project.appspot.com",
                messagingSenderId: "123456789",
                appId: "1:123456789:web:abcdef123456"
            };

            // Ù…ØªØºÙŠØ±Ø§Øª Firebase
            let db = null;

            // ØªÙ‡ÙŠØ¦Ø© Firebase
            useEffect(() => {
                try {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ‡ÙŠØ¦Ø© Firebase
                    const app = firebase.initializeApp(firebaseConfig);
                    db = firebase.firestore();
                    setFirebaseInitialized(true);
                    setUseFirebase(true);
                    showNotification("âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©", "success");
                    
                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
                    loadDataFromFirebase();
                } catch (error) {
                    console.log("Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ¡ Ø£Ùˆ Ù‡Ù†Ø§Ùƒ Ø®Ø·Ø£. Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ.");
                    setUseFirebase(false);
                    loadFromLocalStorage();
                }
            }, []);

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
            async function loadDataFromFirebase() {
                if (!db) return;
                
                setLoading(true);
                try {
                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø·ÙØ§Ù„
                    const childrenSnapshot = await db.collection('children').get();
                    const childrenData = [];
                    childrenSnapshot.forEach(doc => {
                        childrenData.push({ id: doc.id, ...doc.data() });
                    });
                    setChildren(childrenData);

                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª
                    const rewardsSnapshot = await db.collection('rewards').get();
                    const rewardsData = [];
                    rewardsSnapshot.forEach(doc => {
                        rewardsData.push({ id: doc.id, ...doc.data() });
                    });
                    if (rewardsData.length > 0) {
                        setRewards(rewardsData);
                    }
                    
                    showNotification("ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­", "success");
                } catch (error) {
                    console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase:", error);
                    showNotification("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©", "error");
                    loadFromLocalStorage();
                }
                setLoading(false);
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
            function loadFromLocalStorage() {
                const storedChildren = localStorage.getItem("childrenData");
                const storedRewards = localStorage.getItem("rewardsData");
                const storedDarkMode = localStorage.getItem("darkMode");
                
                if (storedChildren) setChildren(JSON.parse(storedChildren));
                if (storedRewards) setRewards(JSON.parse(storedRewards));
                if (storedDarkMode) setDarkMode(JSON.parse(storedDarkMode));
                
                showNotification("ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ", "info");
            }

            // Ø­ÙØ¸ Ø§Ù„Ø£Ø·ÙØ§Ù„ ÙÙŠ Firebase
            async function saveChildrenToFirebase(childrenData) {
                if (!db || !useFirebase) return;
                
                try {
                    for (const child of childrenData) {
                        if (child.id && typeof child.id === 'string' && child.id.length > 10) {
                            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·ÙÙ„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
                            await db.collection('children').doc(child.id).set(child, { merge: true });
                        } else {
                            // Ø¥Ø¶Ø§ÙØ© Ø·ÙÙ„ Ø¬Ø¯ÙŠØ¯
                            const docRef = await db.collection('children').add(child);
                            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø±Ù ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                            setChildren(prev => prev.map(c => 
                                c === child ? { ...c, id: docRef.id } : c
                            ));
                        }
                    }
                } catch (error) {
                    console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø£Ø·ÙØ§Ù„:", error);
                    showNotification("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©", "error");
                }
            }

            // Ø­ÙØ¸ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª ÙÙŠ Firebase
            async function saveRewardsToFirebase(rewardsData) {
                if (!db || !useFirebase) return;
                
                try {
                    for (const reward of rewardsData) {
                        if (reward.id && typeof reward.id === 'string' && reward.id.length > 10) {
                            await db.collection('rewards').doc(reward.id).set(reward, { merge: true });
                        } else {
                            const docRef = await db.collection('rewards').add(reward);
                            setRewards(prev => prev.map(r => 
                                r === reward ? { ...r, id: docRef.id } : r
                            ));
                        }
                    }
                } catch (error) {
                    console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª:", error);
                }
            }

            // Ø§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            useEffect(() => { 
                if (children.length > 0) {
                    saveChildrenToFirebase(children);
                    localStorage.setItem("childrenData", JSON.stringify(children));
                }
                if (rewards.length > 0) {
                    saveRewardsToFirebase(rewards);
                    localStorage.setItem("rewardsData", JSON.stringify(rewards));
                }
                localStorage.setItem("darkMode", JSON.stringify(darkMode));
            }, [children, rewards, darkMode]);

            // Ù…Ø¤Ù‚Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø©
            useEffect(() => {
                let interval;
                if (studyTimer.active && studyTimer.startTime) {
                    interval = setInterval(() => {
                        setChildren(prev => {
                            const updated = [...prev];
                            if (updated[currentChildIndex]) {
                                updated[currentChildIndex].studyTime += 1;
                            }
                            return updated;
                        });
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [studyTimer.active, currentChildIndex]);

            // Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
            function showNotification(message, type = "info") {
                setNotification({ show: true, message, type });
                setTimeout(() => setNotification({ show: false, message: "", type: "" }), 4000);
            }

            // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¤Ù‚Øª
            function startStudyTimer(subjectName) {
                setStudyTimer({
                    active: true,
                    startTime: new Date(),
                    currentSubject: subjectName
                });
                showNotification(`Ø¨Ø¯Ø£Øª Ø¬Ù„Ø³Ø© Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ù„Ù€ ${subjectName}`, "success");
            }

            function stopStudyTimer() {
                if (studyTimer.active) {
                    const endTime = new Date();
                    const duration = Math.round((endTime - studyTimer.startTime) / 1000 / 60);
                    
                    setStudyTimer({ active: false, startTime: null, currentSubject: null });
                    
                    const extraStars = Math.floor(duration / 15);
                    if (extraStars > 0) {
                        setChildren(prev => {
                            const updated = [...prev];
                            if (updated[currentChildIndex]) {
                                updated[currentChildIndex].stars += extraStars;
                            }
                            return updated;
                        });
                        showNotification(`Ù…Ù…ØªØ§Ø²! Ø¯Ø±Ø³Øª ${duration} Ø¯Ù‚ÙŠÙ‚Ø© ÙˆÙƒØ³Ø¨Øª ${extraStars} Ù†Ø¬ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ© â­`, "success");
                    }
                }
            }

            // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‡Ø¯Ø§Ù
            function addGoal() {
                if (!newGoal.title) {
                    showNotification("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‡Ø¯Ù", "error");
                    return;
                }

                const goalWithId = {
                    ...newGoal,
                    id: Date.now(),
                    createdAt: new Date().toISOString(),
                    completed: false,
                    progress: 0
                };

                setChildren(prev => {
                    const updated = [...prev];
                    if (updated[currentChildIndex]) {
                        updated[currentChildIndex].goals.push(goalWithId);
                    }
                    return updated;
                });

                setNewGoal({ title: "", targetDate: "", priority: "Ù…ØªÙˆØ³Ø·", description: "" });
                setShowGoalForm(false);
                showNotification("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‡Ø¯Ù Ø¨Ù†Ø¬Ø§Ø­", "success");
            }

            function toggleGoalCompletion(goalId) {
                setChildren(prev => {
                    const updated = [...prev];
                    const child = updated[currentChildIndex];
                    if (child) {
                        const goal = child.goals.find(g => g.id === goalId);
                        if (goal) {
                            goal.completed = !goal.completed;
                            if (goal.completed) {
                                child.stars += 5;
                                showNotification(`ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù‡Ø¯Ù "${goal.title}" ÙˆÙƒØ³Ø¨Øª 5 Ù†Ø¬ÙˆÙ…`, "success");
                            }
                        }
                    }
                    return updated;
                });
            }

            // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯
            function addSubject() {
                const name = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©:");
                if (!name) return;
                
                const duration = parseInt(prompt("Ø£Ø¯Ø®Ù„ Ù…Ø¯Ø© Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚:"), 10);
                if (isNaN(duration)) {
                    showNotification("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ù„Ù„Ù…Ø¯Ø©", "error");
                    return;
                }

                setNewChild(prev => ({
                    ...prev,
                    subjects: [...prev.subjects, { name, duration, id: Date.now() }]
                }));
                showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© ${name}`, "success");
            }

            function removeSubject(index) {
                const subjectName = newChild.subjects[index]?.name;
                setNewChild(prev => ({
                    ...prev,
                    subjects: prev.subjects.filter((_, i) => i !== index)
                }));
                if (subjectName) {
                    showNotification(`ØªÙ… Ø­Ø°Ù Ù…Ø§Ø¯Ø© ${subjectName}`, "info");
                }
            }

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ù„Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ
            function addSubjectToSchedule(day, subjectName, duration) {
                if (!subjectName) return;
                
                setNewChild(prev => ({
                    ...prev,
                    weeklySchedule: {
                        ...prev.weeklySchedule,
                        [day]: [...prev.weeklySchedule[day], { name: subjectName, duration }]
                    }
                }));
                showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${subjectName} Ù„ÙŠÙˆÙ… ${day}`, "success");
            }

            function removeSubjectFromSchedule(day, index) {
                setNewChild(prev => ({
                    ...prev,
                    weeklySchedule: {
                        ...prev.weeklySchedule,
                        [day]: prev.weeklySchedule[day].filter((_, i) => i !== index)
                    }
                }));
            }

            // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
            function addExam() {
                if (!newExam.subject || !newExam.date) {
                    showNotification("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±", "error");
                    return;
                }

                const examWithId = {
                    ...newExam,
                    id: Date.now(),
                    createdAt: new Date().toISOString()
                };

                setChildren(prev => {
                    const updated = [...prev];
                    if (updated[currentChildIndex]) {
                        updated[currentChildIndex].exams.push(examWithId);
                    }
                    return updated;
                });

                setNewExam({ subject: "", date: "", time: "", importance: "Ø¹Ø§Ø¯ÙŠ", notes: "" });
                setShowExamForm(false);
                showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØ¨Ø§Ø± ${newExam.subject}`, "success");
            }

            function removeExam(index) {
                setChildren(prev => {
                    const updated = [...prev];
                    if (updated[currentChildIndex]) {
                        const examSubject = updated[currentChildIndex].exams[index]?.subject;
                        updated[currentChildIndex].exams = updated[currentChildIndex].exams.filter((_, i) => i !== index);
                        if (examSubject) {
                            showNotification(`ØªÙ… Ø­Ø°Ù Ø§Ø®ØªØ¨Ø§Ø± ${examSubject}`, "info");
                        }
                    }
                    return updated;
                });
            }

            // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª
            function addCustomReward() {
                if (!newReward.name) {
                    showNotification("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©", "error");
                    return;
                }

                const newRewardObj = {
                    ...newReward,
                    id: Date.now(),
                    type: "custom",
                    createdAt: new Date().toISOString()
                };

                setRewards(prev => [...prev, newRewardObj]);
                setNewReward({ name: "", starsRequired: 10, icon: "ğŸ" });
                setShowRewardForm(false);
                showNotification("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø¨Ù†Ø¬Ø§Ø­", "success");
            }

            function removeReward(rewardId) {
                setRewards(prev => prev.filter(reward => reward.id !== rewardId));
                showNotification("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©", "info");
            }

            function claimReward(rewardId) {
                const child = children[currentChildIndex];
                const reward = rewards.find(r => r.id === rewardId);
                
                if (!child || !reward) return;
                
                if (child.stars >= reward.starsRequired) {
                    setChildren(prev => {
                        const updated = [...prev];
                        if (updated[currentChildIndex]) {
                            updated[currentChildIndex].stars -= reward.starsRequired;
                        }
                        return updated;
                    });
                    showNotification(`ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ø§Ø³ØªØ¨Ø¯Ù„Øª ${reward.starsRequired} Ù†Ø¬Ù…Ø© Ø¨${reward.name}`, "success");
                } else {
                    showNotification("âŒ Ø§Ù„Ù†Ø¬ÙˆÙ… ØºÙŠØ± ÙƒØ§ÙÙŠØ©", "error");
                }
            }

            // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
            function generateDailyPlan() {
                const child = children[currentChildIndex];
                if (!child) {
                    showNotification("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·ÙÙ„ Ù…Ø­Ø¯Ø¯", "error");
                    return;
                }
                
                const plan = [
                    { id: 1, time: child.wakeTime, activity: "Ø§Ø³ØªÙŠÙ‚Ø§Ø¸ ÙˆÙØ·ÙˆØ±", type: "routine" },
                    { id: 2, time: "06:00-07:00", activity: "ØªØ­Ø¶ÙŠØ± Ù„Ù„Ù…Ø¯Ø±Ø³Ø©", type: "routine" },
                    { id: 3, time: "07:00-14:00", activity: "Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©", type: "school" }
                ];

                child.subjects.forEach((subject, index) => {
                    plan.push({
                        id: 4 + index,
                        time: `${14 + index}:00-${14 + index + 1}:00`,
                        activity: `Ù…Ø°Ø§ÙƒØ±Ø© ${subject.name}`,
                        type: "study",
                        subject: subject.name,
                        duration: subject.duration
                    });
                });

                plan.push(
                    { id: 100, time: "17:00-18:00", activity: "Ù†Ø´Ø§Ø· Ø¨Ø¯Ù†ÙŠ", type: "physical" },
                    { id: 101, time: child.sleepTime, activity: "ØªØ­Ø¶ÙŠØ± Ù„Ù„Ù†ÙˆÙ…", type: "routine" }
                );

                setDailyPlan(plan);
                showNotification("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ", "success");
            }

            // Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©
            function toggleComplete(activityId) {
                setChildren(prev => {
                    const updated = [...prev];
                    const child = updated[currentChildIndex];
                    if (child) {
                        const isCompleted = child.completed.includes(activityId);
                        if (!isCompleted) {
                            child.completed.push(activityId);
                            child.stars += 1;
                            showNotification(`Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª Ù†Ø¬Ù…Ø© â­`, "success");
                        } else {
                            child.completed = child.completed.filter(id => id !== activityId);
                            child.stars = Math.max(0, child.stars - 1);
                        }
                    }
                    return updated;
                });
            }

            // Ø­Ø°Ù Ø§Ù„Ø·ÙÙ„
            function deleteChild(index) {
                const childName = children[index]?.name;
                if (!childName) return;
                
                if (window.confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ${childName}ØŸ`)) {
                    setChildren(prev => prev.filter((_, i) => i !== index));
                    if (currentChildIndex >= index && currentChildIndex > 0) {
                        setCurrentChildIndex(currentChildIndex - 1);
                    }
                    showNotification(`ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·ÙÙ„ ${childName}`, "info");
                }
            }

            // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            function exportData() {
                const data = {
                    children: children,
                    rewards: rewards,
                    exportDate: new Date().toISOString(),
                    version: "2.0"
                };
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `star-focus-backup-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                showNotification("ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­", "success");
            }

            // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            function importData(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.children) setChildren(data.children);
                        if (data.rewards) setRewards(data.rewards);
                        showNotification("ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­", "success");
                    } catch (error) {
                        showNotification("Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "error");
                    console.error("Error importing data:", error);
                    }
                };
                reader.readAsText(file);
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
                event.target.value = '';
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±
            function calculateAge(birthDate) {
                if (!birthDate) return 0;
                const today = new Date();
                const birth = new Date(birthDate);
                let age = today.getFullYear() - birth.getFullYear();
                const monthDiff = today.getMonth() - birth.getMonth();
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                    age--;
                }
                return age;
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
            function getCurrentDay() {
                const days = ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ø³Ø¨Øª"];
                return days[new Date().getDay()];
            }

            return ( 
                <div className={`min-h-screen transition-colors duration-300 ${darkMode ? 'dark-mode' : 'bg-gradient-to-br from-blue-50 to-purple-50'}`}>
                    <div className="max-w-7xl mx-auto p-4">
                        {/* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */}
                        {notification.show && (
                            <div className={`fixed top-4 left-4 right-4 z-50 p-4 rounded-lg shadow-lg fade-in glass-effect ${
                                notification.type === "success" ? "border-green-200 text-green-800" :
                                notification.type === "error" ? "border-red-200 text-red-800" :
                                "border-blue-200 text-blue-800"
                            }`}>
                                <div className="flex justify-between items-center">
                                    <span className="text-lg">{notification.message}</span>
                                    <button 
                                        onClick={() => setNotification({ show: false, message: "", type: "" })} 
                                        className="text-lg font-bold hover:opacity-70"
                                    >
                                        Ã—
                                    </button>
                                </div>
                            </div>
                        )}
                        
                        {/* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */}
                        {loading && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                <div className="glass-effect rounded-2xl p-8 flex flex-col items-center">
                                    <div className="loading-spinner mb-4"></div>
                                    <div className="text-white text-lg">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
                                </div>
                            </div>
                        )}
                        
                        {/* Ø§Ù„Ù‡ÙŠØ¯Ø± */}
                        <header className="text-center mb-8 pt-4">
                            <div className="flex justify-between items-center mb-4">
                                <div className="flex gap-2">
                                    <button 
                                        onClick={() => setDarkMode(!darkMode)}
                                        className="p-3 rounded-full glass-effect hover-lift"
                                        title={darkMode ? "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ" : "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ"}
                                    >
                                        {darkMode ? "â˜€ï¸" : "ğŸŒ™"}
                                    </button>
                                    {firebaseInitialized && (
                                        <div className={`p-3 rounded-full glass-effect ${useFirebase ? 'firebase-badge' : 'bg-gray-500'}`}>
                                            {useFirebase ? "â˜ï¸" : "ğŸ“±"}
                                        </div>
                                    )}
                                </div>
                                
                                <h1 className="text-4xl font-bold text-white flex items-center justify-center gap-2">
                                    <span className="float-animation">â­</span>
                                    Ù†Ø¬Ù… Ø§Ù„ØªØ±ÙƒÙŠØ²
                                    <span className="float-animation">â­</span>
                                </h1>
                                
                                <div className="flex gap-2">
                                    <button 
                                        onClick={exportData}
                                        className="p-3 rounded-full glass-effect hover-lift text-white"
                                        title="ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"
                                    >
                                        ğŸ“¥
                                    </button>
                                    <label className="p-3 rounded-full glass-effect hover-lift text-white cursor-pointer" title="Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª">
                                        ğŸ“¤
                                        <input 
                                            type="file" 
                                            accept=".json" 
                                            onChange={importData}
                                            className="hidden"
                                        />
                                    </label>
                                </div>
                            </div>
                            <p className="text-lg opacity-80 text-white">
                                {useFirebase ? "Ù…Ù†ØµØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨Ø©" : "Ù…Ù†ØµØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ"}
                            </p>
                        </header>

                        {/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */}
                        {step === 0 ? (
                            // Ø´Ø§Ø´Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø·ÙØ§Ù„
                            <ChildSetupScreen 
                                newChild={newChild}
                                setNewChild={setNewChild}
                                setStep={setStep}
                                showNotification={showNotification}
                                showAvatarSelector={showAvatarSelector}
                                setShowAvatarSelector={setShowAvatarSelector}
                                avatars={avatars}
                                addSubject={addSubject}
                                removeSubject={removeSubject}
                                addSubjectToSchedule={addSubjectToSchedule}
                                removeSubjectFromSchedule={removeSubjectFromSchedule}
                            />
                        ) : (
                            // Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                            <MainScreen 
                                children={children}
                                currentChildIndex={currentChildIndex}
                                setCurrentChildIndex={setCurrentChildIndex}
                                setStep={setStep}
                                activeTab={activeTab}
                                setActiveTab={setActiveTab}
                                dailyPlan={dailyPlan}
                                studyTimer={studyTimer}
                                startStudyTimer={startStudyTimer}
                                stopStudyTimer={stopStudyTimer}
                                generateDailyPlan={generateDailyPlan}
                                toggleComplete={toggleComplete}
                                showExamForm={showExamForm}
                                setShowExamForm={setShowExamForm}
                                newExam={newExam}
                                setNewExam={setNewExam}
                                addExam={addExam}
                                removeExam={removeExam}
                                showGoalForm={showGoalForm}
                                setShowGoalForm={setShowGoalForm}
                                newGoal={newGoal}
                                setNewGoal={setNewGoal}
                                addGoal={addGoal}
                                toggleGoalCompletion={toggleGoalCompletion}
                                showRewardForm={showRewardForm}
                                setShowRewardForm={setShowRewardForm}
                                newReward={newReward}
                                setNewReward={setNewReward}
                                addCustomReward={addCustomReward}
                                removeReward={removeReward}
                                claimReward={claimReward}
                                rewards={rewards}
                                deleteChild={deleteChild}
                                calculateAge={calculateAge}
                                getCurrentDay={getCurrentDay}
                            />
                        )}
                    </div>
                </div>
            );
        }

        // Ù…ÙƒÙˆÙ† Ø´Ø§Ø´Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø·ÙØ§Ù„
        function ChildSetupScreen({ 
            newChild, setNewChild, setStep, showNotification, 
            showAvatarSelector, setShowAvatarSelector, avatars,
            addSubject, removeSubject, addSubjectToSchedule, removeSubjectFromSchedule
        }) {
            return (
                <div className="glass-effect rounded-2xl p-6 shadow-xl fade-in">
                    <div className="max-w-4xl mx-auto">
                        <h2 className="text-3xl font-bold text-center mb-8 text-white">Ø¥Ø¶Ø§ÙØ© Ø·ÙÙ„ Ø¬Ø¯ÙŠØ¯</h2>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div className="space-y-4">
                                {/* Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ÙØ§ØªØ§Ø± */}
                                <div>
                                    <label className="block mb-2 text-lg text-white">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©</label>
                                    <div className="flex items-center gap-4">
                                        <button 
                                            onClick={() => setShowAvatarSelector(!showAvatarSelector)}
                                            className="text-4xl p-4 rounded-2xl glass-effect hover-lift"
                                        >
                                            {newChild.avatar}
                                        </button>
                                        <span className="text-sm opacity-70 text-white">Ø§Ù†Ù‚Ø± Ù„ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©</span>
                                    </div>
                                    
                                    {showAvatarSelector && (
                                        <div className="mt-4 p-4 glass-effect rounded-2xl">
                                            <h4 className="text-white mb-3 text-center">Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø±Ù…Ø²ÙŠØ©</h4>
                                            <div className="grid grid-cols-5 gap-3">
                                                {avatars.map(avatar => (
                                                    <button
                                                        key={avatar}
                                                        onClick={() => {
                                                            setNewChild(prev => ({ ...prev, avatar }));
                                                            setShowAvatarSelector(false);
                                                        }}
                                                        className="text-2xl p-3 rounded-xl hover:bg-white hover:bg-opacity-20 transition-all"
                                                    >
                                                        {avatar}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                                
                                <div>
                                    <label className="block mb-2 text-lg text-white">Ø§Ø³Ù… Ø§Ù„Ø·ÙÙ„</label>
                                    <input 
                                        type="text"
                                        value={newChild.name}
                                        onChange={(e) => setNewChild(prev => ({ ...prev, name: e.target.value }))}
                                        placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·ÙÙ„"
                                        className="w-full p-3 rounded-xl glass-effect text-white placeholder-gray-300"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block mb-2 text-lg text-white">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
                                    <input 
                                        type="date"
                                        value={newChild.birthDate}
                                        onChange={(e) => setNewChild(prev => ({ ...prev, birthDate: e.target.value }))}
                                        className="w-full p-3 rounded-xl glass-effect text-white"
                                    />
                                </div>
                            </div>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block mb-2 text-lg text-white">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ±ÙƒÙŠØ²</label>
                                    <div className="flex gap-2">
                                        {['Ù…Ù†Ø®ÙØ¶', 'Ù…ØªÙˆØ³Ø·', 'Ù…Ø±ØªÙØ¹'].map(level => (
                                            <button
                                                key={level}
                                                onClick={() => setNewChild(prev => ({ ...prev, focusLevel: level }))}
                                                className={`flex-1 p-4 rounded-xl transition-all ${
                                                    newChild.focusLevel === level 
                                                        ? 'bg-white bg-opacity-30 text-white shadow-lg' 
                                                        : 'glass-effect hover-lift text-white'
                                                }`}
                                            >
                                                {level}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                
                                <div>
                                    <label className="block mb-2 text-lg text-white">ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªÙŠÙ‚Ø§Ø¸</label>
                                    <input 
                                        type="time"
                                        value={newChild.wakeTime}
                                        onChange={(e) => setNewChild(prev => ({ ...prev, wakeTime: e.target.value }))}
                                        className="w-full p-3 rounded-xl glass-effect text-white"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block mb-2 text-lg text-white">ÙˆÙ‚Øª Ø§Ù„Ù†ÙˆÙ…</label>
                                    <input 
                                        type="time"
                                        value={newChild.sleepTime}
                                        onChange={(e) => setNewChild(prev => ({ ...prev, sleepTime: e.target.value }))}
                                        className="w-full p-3 rounded-xl glass-effect text-white"
                                    />
                                </div>
                            </div>
                        </div>

                        {/* Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© */}
                        <div className="mb-6">
                            <h3 className="text-xl font-bold mb-4 text-white">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h3>
                            <div className="space-y-2 mb-4">
                                {newChild.subjects.length === 0 ? (
                                    <p className="text-white text-center py-4">Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…ÙˆØ§Ø¯ Ø¨Ø¹Ø¯</p>
                                ) : (
                                    newChild.subjects.map((subject, index) => (
                                        <div key={index} className="flex justify-between items-center p-3 glass-effect rounded-xl">
                                            <span className="text-white">{subject.name} - {subject.duration} Ø¯Ù‚ÙŠÙ‚Ø©</span>
                                            <button 
                                                onClick={() => removeSubject(index)}
                                                className="text-red-400 hover:text-red-300"
                                            >
                                                Ø­Ø°Ù
                                            </button>
                                        </div>
                                    ))
                                )}
                            </div>
                            <button 
                                onClick={addSubject}
                                className="w-full p-3 glass-effect rounded-xl text-white hover:bg-white hover:bg-opacity-20 transition-all"
                            >
                                + Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
                            </button>
                        </div>

                        {/* Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ */}
                        <div className="mb-6">
                            <h3 className="text-xl font-bold mb-4 text-white">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {Object.entries(newChild.weeklySchedule).map(([day, subjects]) => (
                                    <div key={day} className="glass-effect rounded-2xl p-4">
                                        <h4 className="font-bold text-lg mb-2 text-center text-white bg-white bg-opacity-20 py-2 rounded-lg">
                                            {day}
                                        </h4>
                                        <div className="space-y-2">
                                            {subjects.length === 0 ? (
                                                <p className="text-white text-center text-sm py-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯</p>
                                            ) : (
                                                subjects.map((subject, index) => (
                                                    <div key={index} className="flex justify-between items-center p-2 bg-white bg-opacity-10 rounded-lg">
                                                        <span className="text-white text-sm">{subject.name}</span>
                                                        <button 
                                                            onClick={() => removeSubjectFromSchedule(day, index)}
                                                            className="text-red-400 hover:text-red-300 text-sm"
                                                        >
                                                            Ø­Ø°Ù
                                                        </button>
                                                    </div>
                                                ))
                                            )}
                                            <select 
                                                className="w-full p-2 rounded-lg glass-effect text-white text-sm"
                                                onChange={(e) => {
                                                    const selectedSubject = newChild.subjects.find(s => s.name === e.target.value);
                                                    if (selectedSubject) {
                                                        addSubjectToSchedule(day, selectedSubject.name, selectedSubject.duration);
                                                    }
                                                    e.target.value = "";
                                                }}
                                            >
                                                <option value="">Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©...</option>
                                                {newChild.subjects.map(subject => (
                                                    <option key={subject.id} value={subject.name}>
                                                        {subject.name} ({subject.duration} Ø¯)
                                                    </option>
                                                ))}
                                            </select>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        <button 
                            onClick={() => {
                                if (!newChild.name) {
                                    showNotification("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø·ÙÙ„", "error");
                                    return;
                                }
                                if (newChild.subjects.length === 0) {
                                    showNotification("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„", "error");
                                    return;
                                }
                                
                                const childWithId = { 
                                    ...newChild, 
                                    id: Date.now().toString(),
                                    createdAt: new Date().toISOString()
                                };
                                
                                // Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·ÙÙ„ Ø¹Ø¨Ø± useEffect
                                setStep(1);
                                showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·ÙÙ„ ${newChild.name} Ø¨Ù†Ø¬Ø§Ø­`, "success");
                                
                                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                                setNewChild({ 
                                    name: "", birthDate: "", focusLevel: "Ù…ØªÙˆØ³Ø·", 
                                    wakeTime: "05:30", sleepTime: "20:30", subjects: [], 
                                    exams: [], weeklySchedule: {
                                        Ø§Ù„Ø³Ø¨Øª: [], Ø§Ù„Ø£Ø­Ø¯: [], Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†: [], Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡: [], Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡: [], Ø§Ù„Ø®Ù…ÙŠØ³: [], Ø§Ù„Ø¬Ù…Ø¹Ø©: []
                                    },
                                    goals: [], stars: 0, completed: [], achievements: [],
                                    studyTime: 0, avatar: "ğŸ‘¦", createdAt: new Date().toISOString()
                                });
                            }}
                            className="w-full bg-white bg-opacity-20 text-white p-4 rounded-2xl text-xl font-bold hover:bg-opacity-30 transition-all"
                        >
                            Ø¨Ø¯Ø¡ Ø§Ù„Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ğŸš€
                        </button>
                    </div>
                </div>
            );
        }

        // Ù…ÙƒÙˆÙ† Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        function MainScreen({
            children, currentChildIndex, setCurrentChildIndex, setStep,
            activeTab, setActiveTab, dailyPlan, studyTimer, startStudyTimer, stopStudyTimer,
            generateDailyPlan, toggleComplete, showExamForm, setShowExamForm, newExam, setNewExam,
            addExam, removeExam, showGoalForm, setShowGoalForm, newGoal, setNewGoal, addGoal,
            toggleGoalCompletion, showRewardForm, setShowRewardForm, newReward, setNewReward,
            addCustomReward, removeReward, claimReward, rewards, deleteChild, calculateAge, getCurrentDay
        }) {
            const currentChild = children[currentChildIndex];
            
            if (!currentChild) {
                return (
                    <div className="text-center py-12">
                        <p className="text-white text-xl mb-4">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø·ÙØ§Ù„ Ù…Ø³Ø¬Ù„ÙŠÙ†</p>
                        <button
                            onClick={() => setStep(0)}
                            className="bg-blue-500 text-white p-4 rounded-2xl text-lg hover:bg-blue-600 transition-all"
                        >
                            Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø·ÙÙ„
                        </button>
                    </div>
                );
            }

            return (
                <div className="space-y-6 fade-in">
                    {/* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø·ÙØ§Ù„ */}
                    <div className="glass-effect rounded-2xl p-4">
                        <div className="flex justify-between items-center mb-4">
                            <h2 className="text-2xl font-bold text-white">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„</h2>
                            <button
                                onClick={() => setStep(0)}
                                className="bg-green-500 text-white p-3 rounded-xl hover:bg-green-600 transition-all"
                            >
                                + Ø·ÙÙ„ Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                        
                        <div className="flex gap-2 overflow-x-auto pb-2">
                            {children.map((child, index) => (
                                <button
                                    key={child.id}
                                    onClick={() => setCurrentChildIndex(index)}
                                    className={`p-4 rounded-xl min-w-32 text-center transition-all flex-shrink-0 ${
                                        currentChildIndex === index 
                                            ? 'bg-white bg-opacity-30 text-white shadow-lg' 
                                            : 'glass-effect text-white hover:bg-white hover:bg-opacity-10'
                                    }`}
                                >
                                    <div className="text-2xl mb-2">{child.avatar}</div>
                                    <div className="font-bold truncate">{child.name}</div>
                                    <div className="text-sm">â­ {child.stars}</div>
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */}
                    <div className="glass-effect rounded-2xl p-6">
                        <div className="flex justify-between items-start mb-6">
                            <div>
                                <h2 className="text-3xl font-bold text-white">
                                    {currentChild.name} {currentChild.avatar}
                                </h2>
                                <p className="text-white opacity-80">
                                    Ø§Ù„Ø¹Ù…Ø±: {calculateAge(currentChild.birthDate)} Ø³Ù†Ø© â€¢ 
                                    Ø§Ù„Ù…Ø³ØªÙˆÙ‰: {currentChild.focusLevel} â€¢ 
                                    â­ {currentChild.stars} Ù†Ø¬Ù…Ø©
                                </p>
                                <div className="flex gap-4 mt-4">
                                    <div className="text-center">
                                        <div className="text-2xl text-white">{currentChild.subjects.length}</div>
                                        <div className="text-white opacity-80">Ù…Ø§Ø¯Ø©</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-2xl text-white">{currentChild.exams.length}</div>
                                        <div className="text-white opacity-80">Ø§Ø®ØªØ¨Ø§Ø±</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-2xl text-white">{Math.floor(currentChild.studyTime / 60)}</div>
                                        <div className="text-white opacity-80">Ø¯Ù‚ÙŠÙ‚Ø© Ø¯Ø±Ø§Ø³Ø©</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-2xl text-white">{currentChild.goals.filter(g => g.completed).length}</div>
                                        <div className="text-white opacity-80">Ù‡Ø¯Ù Ù…ÙƒØªÙ…Ù„</div>
                                    </div>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={generateDailyPlan}
                                    className="bg-green-500 text-white p-3 rounded-xl hover:bg-green-600 transition-all"
                                >
                                    ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„
                                </button>
                                <button
                                    onClick={() => {
                                        if (window.confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙ‚Ø¯Ù…ØŸ")) {
                                            // Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¹Ø¨Ø± useEffect
                                            showNotification("ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†", "info");
                                        }
                                    }}
                                    className="bg-gray-500 text-white p-3 rounded-xl hover:bg-gray-600 transition-all"
                                >
                                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                                </button>
                                <button
                                    onClick={() => deleteChild(currentChildIndex)}
                                    className="bg-red-500 text-white p-3 rounded-xl hover:bg-red-600 transition-all"
                                >
                                    Ø­Ø°Ù
                                </button>
                            </div>
                        </div>

                        {/* Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª */}
                        <div className="flex overflow-x-auto gap-2 mb-6 pb-2">
                            {["Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", "Ø§Ù„Ø¬Ø¯ÙˆÙ„", "Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª", "Ø§Ù„Ø£Ù‡Ø¯Ø§Ù", "Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª"].map(tab => (
                                <button
                                    key={tab}
                                    onClick={() => setActiveTab(tab)}
                                    className={`px-4 py-2 rounded-xl whitespace-nowrap transition-all flex-shrink-0 ${
                                        activeTab === tab 
                                            ? 'bg-white bg-opacity-30 text-white' 
                                            : 'glass-effect text-white hover:bg-white hover:bg-opacity-10'
                                    }`}
                                >
                                    {tab}
                                </button>
                            ))}
                        </div>

                        {/* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */}
                        <div className="fade-in">
                            {activeTab === "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" && <DashboardTab currentChild={currentChild} />}
                            {activeTab === "Ø§Ù„Ø¬Ø¯ÙˆÙ„" && (
                                <ScheduleTab 
                                    dailyPlan={dailyPlan}
                                    studyTimer={studyTimer}
                                    startStudyTimer={startStudyTimer}
                                    stopStudyTimer={stopStudyTimer}
                                    currentChild={currentChild}
                                    toggleComplete={toggleComplete}
                                    getCurrentDay={getCurrentDay}
                                />
                            )}
                            {activeTab === "Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª" && (
                                <ExamsTab
                                    currentChild={currentChild}
                                    showExamForm={showExamForm}
                                    setShowExamForm={setShowExamForm}
                                    newExam={newExam}
                                    setNewExam={setNewExam}
                                    addExam={addExam}
                                    removeExam={removeExam}
                                />
                            )}
                            {activeTab === "Ø§Ù„Ø£Ù‡Ø¯Ø§Ù" && (
                                <GoalsTab
                                    currentChild={currentChild}
                                    showGoalForm={showGoalForm}
                                    setShowGoalForm={setShowGoalForm}
                                    newGoal={newGoal}
                                    setNewGoal={setNewGoal}
                                    addGoal={addGoal}
                                    toggleGoalCompletion={toggleGoalCompletion}
                                />
                            )}
                            {activeTab === "Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª" && (
                                <RewardsTab
                                    currentChild={currentChild}
                                    rewards={rewards}
                                    showRewardForm={showRewardForm}
                                    setShowRewardForm={setShowRewardForm}
                                    newReward={newReward}
                                    setNewReward={setNewReward}
                                    addCustomReward={addCustomReward}
                                    removeReward={removeReward}
                                    claimReward={claimReward}
                                />
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function DashboardTab({ currentChild }) {
            return (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                        <div className="text-3xl mb-2">ğŸ“š</div>
                        <div className="text-white font-bold text-xl">{currentChild.subjects.length}</div>
                        <div className="text-white opacity-80">Ù…Ø§Ø¯Ø© Ù…Ø³Ø¬Ù„Ø©</div>
                    </div>
                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                        <div className="text-3xl mb-2">â­</div>
                        <div className="text-white font-bold text-xl">{currentChild.stars}</div>
                        <div className="text-white opacity-80">Ù†Ø¬Ù…Ø© Ù…ÙƒØªØ³Ø¨Ø©</div>
                    </div>
                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                        <div className="text-3xl mb-2">â±ï¸</div>
                        <div className="text-white font-bold text-xl">{Math.floor(currentChild.studyTime / 60)}</div>
                        <div className="text-white opacity-80">Ø¯Ù‚ÙŠÙ‚Ø© Ø¯Ø±Ø§Ø³Ø©</div>
                    </div>
                    <div className="glass-effect rounded-2xl p-4 text-center hover-lift">
                        <div className="text-3xl mb-2">ğŸ¯</div>
                        <div className="text-white font-bold text-xl">{currentChild.goals.filter(g => g.completed).length}/{currentChild.goals.length}</div>
                        <div className="text-white opacity-80">Ø£Ù‡Ø¯Ø§Ù Ù…ÙƒØªÙ…Ù„Ø©</div>
                    </div>
                </div>
            );
        }

        function ScheduleTab({ dailyPlan, studyTimer, startStudyTimer, stopStudyTimer, currentChild, toggleComplete, getCurrentDay }) {
            return (
                <div>
                    <div className="flex justify-between items-center mb-4">
                        <h3 className="text-2xl font-bold text-white">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ - {getCurrentDay()}</h3>
                        {studyTimer.active && (
                            <button
                                onClick={stopStudyTimer}
                                className="bg-red-500 text-white p-3 rounded-xl hover:bg-red-600 transition-all"
                            >
                                â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª - {studyTimer.currentSubject}
                            </button>
                        )}
                    </div>
                    {dailyPlan.length === 0 ? (
                        <div className="text-center py-8">
                            <p className="text-white text-lg mb-4">Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¨Ø¹Ø¯</p>
                            <p className="text-white opacity-80">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„" Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…</p>
                        </div>
                    ) : (
                        <div className="space-y-3">
                            {dailyPlan.map((item) => (
                                <div 
                                    key={item.id} 
                                    className={`glass-effect rounded-2xl p-4 transition-all ${
                                        currentChild.completed.includes(item.id) ? 'bg-green-500 bg-opacity-20' : ''
                                    }`}
                                >
                                    <div className="flex justify-between items-center">
                                        <div className="flex-1">
                                            <div className="text-white font-bold text-lg">{item.activity}</div>
                                            <div className="text-white opacity-80">{item.time}</div>
                                            {item.duration && (
                                                <div className="text-white opacity-60 text-sm">{item.duration} Ø¯Ù‚ÙŠÙ‚Ø©</div>
                                            )}
                                        </div>
                                        <div className="flex gap-2">
                                            {item.type === "study" && !studyTimer.active && (
                                                <button
                                                    onClick={() => startStudyTimer(item.activity)}
                                                    className="bg-green-500 text-white p-2 rounded-xl hover:bg-green-600 transition-all"
                                                >
                                                    Ø¨Ø¯Ø¡ Ø§Ù„Ø¯Ø±Ø§Ø³Ø©
                                                </button>
                                            )}
                                            <button
                                                onClick={() => toggleComplete(item.id)}
                                                className={`p-2 rounded-xl transition-all ${
                                                    currentChild.completed.includes(item.id)
                                                        ? 'bg-green-500 text-white'
                                                        : 'glass-effect text-white hover:bg-white hover:bg-opacity-20'
                                                }`}
                                            >
                                                {currentChild.completed.includes(item.id) ? 'âœ“ Ù…ÙƒØªÙ…Ù„' : 'Ø¥Ù†Ø¬Ø§Ø²'}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

        function ExamsTab({ currentChild, showExamForm, setShowExamForm, newExam, setNewExam, addExam, removeExam }) {
            return (
                <div>
                    <div className="flex justify-between items-center mb-4">
                        <h3 className="text-2xl font-bold text-white">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
                        <button
                            onClick={() => setShowExamForm(true)}
                            className="bg-red-500 text-white p-3 rounded-xl hover:bg-red-600 transition-all"
                        >
                            + Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>

                    {showExamForm && (
                        <div className="glass-effect rounded-2xl p-4 mb-4">
                            <h4 className="text-white font-bold mb-3 text-lg">Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯</h4>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3">
                                <input
                                    type="text"
                                    placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©"
                                    value={newExam.subject}
                                    onChange={(e) => setNewExam(prev => ({ ...prev, subject: e.target.value }))}
                                    className="p-3 rounded-xl glass-effect text-white placeholder-gray-300"
                                />
                                <input
                                    type="date"
                                    value={newExam.date}
                                    onChange={(e) => setNewExam(prev => ({ ...prev, date: e.target.value }))}
                                    className="p-3 rounded-xl glass-effect text-white"
                                />
                                <input
                                    type="time"
                                    placeholder="ÙˆÙ‚Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
                                    value={newExam.time}
                                    onChange={(e) => setNewExam(prev => ({ ...prev, time: e.target.value }))}
                                    className="p-3 rounded-xl glass-effect text-white"
                                />
                                <select
                                    value={newExam.importance}
                                    onChange={(e) => setNewExam(prev => ({ ...prev, importance: e.target.value }))}
                                    className="p-3 rounded-xl glass-effect text-white"
                                >
                                    <option value="Ø¹Ø§Ø¯ÙŠ">Ø¹Ø§Ø¯ÙŠ</option>
                                    <option value="Ù…Ù‡Ù…">Ù…Ù‡Ù…</option>
                                    <option value="Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹">Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹</option>
                                </select>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={addExam}
                                    className="bg-green-500 text-white p-3 rounded-xl flex-1 hover:bg-green-600 transition-all"
                                >
                                    Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                                </button>
                                <button
                                    onClick={() => setShowExamForm(false)}
                                    className="bg-gray-500 text-white p-3 rounded-xl flex-1 hover:bg-gray-600 transition-all"
                                >
                                    Ø¥Ù„ØºØ§Ø¡
                                </button>
                            </div>
                        </div>
                    )}

                    <div className="space-y-3">
                        {currentChild.exams.length === 0 ? (
                            <div className="text-center py-8">
                                <p className="text-white text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø³Ø¬Ù„Ø©</p>
                            </div>
                        ) : (
                            currentChild.exams.map((exam, index) => (
                                <div key={index} className="glass-effect rounded-2xl p-4">
                                    <div className="flex justify-between items-start">
                                        <div className="flex-1">
                                            <div className="text-white font-bold text-lg">{exam.subject}</div>
                                            <div className="text-white opacity-80">
                                                ğŸ“… {exam.date} {exam.time && `â€¢ â° ${exam.time}`}
                                            </div>
                                            <div className="flex gap-2 mt-2">
                                                <span className={`px-2 py-1 rounded text-sm ${
                                                    exam.importance === "Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹" ? "bg-red-500 text-white" :
                                                    exam.importance === "Ù…Ù‡Ù…" ? "bg-orange-500 text-white" :
                                                    "bg-blue-500 text-white"
                                                }`}>
                                                    {exam.importance}
                                                </span>
                                            </div>
                                        </div>
                                        <button 
                                            onClick={() => removeExam(index)}
                                            className="text-red-400 hover:text-red-300 p-2"
                                        >
                                            Ø­Ø°Ù
                                        </button>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                </div>
            );
        }

        function GoalsTab({ currentChild, showGoalForm, setShowGoalForm, newGoal, setNewGoal, addGoal, toggleGoalCompletion }) {
            return (
                <div>
                    <div className="flex justify-between items-center mb-4">
                        <h3 className="text-2xl font-bold text-white">Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h3>
                        <button
                            onClick={() => setShowGoalForm(true)}
                            className="bg-blue-500 text-white p-3 rounded-xl hover:bg-blue-600 transition-all"
                        >
                            + Ù‡Ø¯Ù Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>

                    {showGoalForm && (
                        <div className="glass-effect rounded-2xl p-4 mb-4">
                            <h4 className="text-white font-bold mb-3 text-lg">Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù Ø¬Ø¯ÙŠØ¯</h4>
                            <div className="space-y-3 mb-3">
                                <input
                                    type="text"
                                    placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‡Ø¯Ù"
                                    value={newGoal.title}
                                    onChange={(e) => setNewGoal(prev => ({ ...prev, title: e.target.value }))}
                                    className="w-full p-3 rounded-xl glass-effect text-white placeholder-gray-300"
                                />
                                <input
                                    type="date"
                                    placeholder="ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¯Ù"
                                    value={newGoal.targetDate}
                                    onChange={(e) => setNewGoal(prev => ({ ...prev, targetDate: e.target.value }))}
                                    className="w-full p-3 rounded-xl glass-effect text-white"
                                />
                                <textarea
                                    placeholder="ÙˆØµÙ Ø§Ù„Ù‡Ø¯Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
                                    value={newGoal.description}
                                    onChange={(e) => setNewGoal(prev => ({ ...prev, description: e.target.value }))}
                                    className="w-full p-3 rounded-xl glass-effect text-white placeholder-gray-300"
                                    rows="3"
                                />
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={addGoal}
                                    className="bg-green-500 text-white p-3 rounded-xl flex-1 hover:bg-green-600 transition-all"
                                >
                                    Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‡Ø¯Ù
                                </button>
                                <button
                                    onClick={() => setShowGoalForm(false)}
                                    className="bg-gray-500 text-white p-3 rounded-xl flex-1 hover:bg-gray-600 transition-all"
                                >
                                    Ø¥Ù„ØºØ§Ø¡
                                </button>
                            </div>
                        </div>
                    )}

                    <div className="space-y-3">
                        {currentChild.goals.length === 0 ? (
                            <div className="text-center py-8">
                                <p className="text-white text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‡Ø¯Ø§Ù Ù…Ø³Ø¬Ù„Ø©</p>
                            </div>
                        ) : (
                            currentChild.goals.map((goal, index) => (
                                <div 
                                    key={goal.id} 
                                    className={`glass-effect rounded-2xl p-4 transition-all ${
                                        goal.completed ? 'bg-green-500 bg-opacity-20' : ''
                                    }`}
                                >
                                    <div className="flex justify-between items-start">
                                        <div className="flex-1">
                                            <div className="text-white font-bold text-lg">{goal.title}</div>
                                            {goal.targetDate && (
                                                <div className="text-white opacity-80">ğŸ“… {goal.targetDate}</div>
                                            )}
                                            {goal.description && (
                                                <div className="text-white opacity-60 mt-2">{goal.description}</div>
                                            )}
                                        </div>
                                        <button
                                            onClick={() => toggleGoalCompletion(goal.id)}
                                            className={`p-3 rounded-xl transition-all ${
                                                goal.completed 
                                                    ? 'bg-green-500 text-white' 
                                                    : 'bg-gray-500 text-white hover:bg-gray-600'
                                            }`}
                                        >
                                            {goal.completed ? 'âœ“ Ù…ÙƒØªÙ…Ù„' : 'ØºÙŠØ± Ù…ÙƒØªÙ…Ù„'}
                                        </button>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                </div>
            );
        }

        function RewardsTab({ currentChild, rewards, showRewardForm, setShowRewardForm, newReward, setNewReward, addCustomReward, removeReward, claimReward }) {
            return (
                <div>
                    <div className="flex justify-between items-center mb-4">
                        <h3 className="text-2xl font-bold text-white">Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h3>
                        <div className="flex gap-2">
                            <div className="bg-yellow-500 text-white p-3 rounded-xl">
                                â­ {currentChild.stars} Ù†Ø¬Ù…Ø©
                            </div>
                            <button
                                onClick={() => setShowRewardForm(true)}
                                className="bg-purple-500 text-white p-3 rounded-xl hover:bg-purple-600 transition-all"
                            >
                                + Ù…ÙƒØ§ÙØ£Ø© Ø¬Ø¯ÙŠØ¯Ø©
                            </button>
                        </div>
                    </div>

                    {showRewardForm && (
                        <div className="glass-effect rounded-2xl p-4 mb-4">
                            <h4 className="text-white font-bold mb-3 text-lg">Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØ§ÙØ£Ø© Ø¬Ø¯ÙŠØ¯Ø©</h4>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3">
                                <input
                                    type="text"
                                    placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©"
                                    value={newReward.name}
                                    onChange={(e) => setNewReward(prev => ({ ...prev, name: e.target.value }))}
                                    className="p-3 rounded-xl glass-effect text-white placeholder-gray-300"
                                />
                                <input
                                    type="number"
                                    placeholder="Ø§Ù„Ù†Ø¬ÙˆÙ… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©"
                                    value={newReward.starsRequired}
                                    onChange={(e) => setNewReward(prev => ({ ...prev, starsRequired: parseInt(e.target.value) || 0 }))}
                                    className="p-3 rounded-xl glass-effect text-white"
                                />
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={addCustomReward}
                                    className="bg-green-500 text-white p-3 rounded-xl flex-1 hover:bg-green-600 transition-all"
                                >
                                    Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©
                                </button>
                                <button
                                    onClick={() => setShowRewardForm(false)}
                                    className="bg-gray-500 text-white p-3 rounded-xl flex-1 hover:bg-gray-600 transition-all"
                                >
                                    Ø¥Ù„ØºØ§Ø¡
                                </button>
                            </div>
                        </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        {rewards.length === 0 ? (
                            <div className="col-span-full text-center py-8">
                                <p className="text-white text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙƒØ§ÙØ¢Øª Ù…ØªØ§Ø­Ø©</p>
                            </div>
                        ) : (
                            rewards.map(reward => (
                                <div key={reward.id} className="glass-effect rounded-2xl p-4 text-center hover-lift">
                                    <div className="text-3xl mb-2">{reward.icon}</div>
                                    <div className="text-white font-bold text-lg mb-2">{reward.name}</div>
                                    <div className="text-yellow-400 font-bold text-xl mb-3">{reward.starsRequired} â­</div>
                                    <div className="flex gap-2">
                                        <button
                                            onClick={() => claimReward(reward.id)}
                                            disabled={currentChild.stars < reward.starsRequired}
                                            className={`flex-1 p-2 rounded-xl transition-all ${
                                                currentChild.stars >= reward.starsRequired
                                                    ? 'bg-green-500 hover:bg-green-600 text-white'
                                                    : 'bg-gray-500 cursor-not-allowed text-white'
                                            }`}
                                        >
                                            {currentChild.stars >= reward.starsRequired ? 'Ø§Ø³ØªØ¨Ø¯Ø§Ù„' : 'Ù†Ù‚Ø§Ø· ØºÙŠØ± ÙƒØ§ÙÙŠØ©'}
                                        </button>
                                        {reward.type === "custom" && (
                                            <button
                                                onClick={() => removeReward(reward.id)}
                                                className="bg-red-500 text-white p-2 rounded-xl hover:bg-red-600 transition-all"
                                            >
                                                Ø­Ø°Ù
                                            </button>
                                        )}
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                </div>
            );
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
